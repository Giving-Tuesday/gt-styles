<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GivingTuesday Data Commons - Leaflet Map Demo</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --gt-red: #ED132E;
      --gt-navy: #001548;
      --gt-lavender: #CAC7F8;
      --gt-light-blue: #6CF4FF;
      --gt-beige: #FDF7F7;
      --gt-teal: #0fb5c3;
      --gt-teal-hover: #10c8d8;
      --gt-white: #ffffff;
      --gt-copy: #1b1a19;
      --gt-light-bg: #f4f4f1;
      --gt-divider: #e0e0e0;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: var(--gt-light-bg);
      color: var(--gt-copy);
    }

    .page-header {
      background: var(--gt-navy);
      color: var(--gt-white);
      padding: 24px 32px;
    }

    .page-header h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
    }

    .page-header p {
      margin: 8px 0 0;
      opacity: 0.8;
      font-size: 14px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 32px;
    }

    .map-section {
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 24px;
    }

    @media (max-width: 900px) {
      .map-section {
        grid-template-columns: 1fr;
      }
    }

    .map-container {
      height: 600px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 24px rgba(0,0,0,0.1);
    }

    #map {
      height: 100%;
      width: 100%;
    }

    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .panel {
      background: var(--gt-white);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    }

    .panel__title {
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--gt-navy);
      margin: 0 0 16px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      flex-shrink: 0;
    }

    .legend-label {
      font-size: 13px;
      color: var(--gt-copy);
    }

    .stat-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .stat-item {
      text-align: center;
      padding: 16px;
      background: var(--gt-light-bg);
      border-radius: 12px;
    }

    .stat-number {
      font-size: 24px;
      font-weight: 700;
      color: var(--gt-red);
      line-height: 1;
    }

    .stat-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--gt-navy);
      margin-top: 4px;
    }

    .filter-group {
      margin-bottom: 16px;
    }

    .filter-group:last-child {
      margin-bottom: 0;
    }

    .filter-label {
      display: block;
      font-size: 12px;
      font-weight: 500;
      color: var(--gt-navy);
      margin-bottom: 8px;
    }

    .filter-select {
      width: 100%;
      padding: 10px 12px;
      font-family: 'Montserrat', sans-serif;
      font-size: 14px;
      border: 1px solid var(--gt-divider);
      border-radius: 8px;
      background: var(--gt-white);
      color: var(--gt-navy);
      cursor: pointer;
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--gt-teal);
      box-shadow: 0 0 0 3px rgba(15, 181, 195, 0.2);
    }

    /* Leaflet overrides (GT theme) */
    .leaflet-popup-content-wrapper {
      font-family: 'Montserrat', sans-serif;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
      padding: 0;
    }

    .leaflet-popup-content {
      margin: 16px 20px;
      font-size: 14px;
      line-height: 1.5;
      color: var(--gt-navy);
    }

    .leaflet-popup-close-button {
      color: var(--gt-copy) !important;
      font-size: 20px !important;
      padding: 8px !important;
    }

    .leaflet-control-zoom {
      border: none !important;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1) !important;
      border-radius: 8px !important;
      overflow: hidden;
    }

    .leaflet-control-zoom a {
      background: var(--gt-white) !important;
      color: var(--gt-navy) !important;
      border: none !important;
      width: 36px !important;
      height: 36px !important;
      line-height: 36px !important;
      font-size: 18px !important;
      font-weight: 600 !important;
    }

    .leaflet-control-zoom a:hover {
      background: var(--gt-beige) !important;
    }

    .leaflet-control-zoom a:first-child {
      border-bottom: 1px solid var(--gt-divider) !important;
    }

    /* Custom popup styles */
    .gt-popup__header {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--gt-red);
      margin-bottom: 4px;
    }

    .gt-popup__title {
      font-size: 16px;
      font-weight: 600;
      color: var(--gt-navy);
      margin: 0 0 12px;
    }

    .gt-popup__stat {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid var(--gt-divider);
    }

    .gt-popup__stat:last-child {
      border-bottom: none;
    }

    .gt-popup__stat-label {
      color: var(--gt-copy);
    }

    .gt-popup__stat-value {
      font-weight: 600;
      color: var(--gt-navy);
    }

    /* Custom markers */
    .gt-marker {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      background: var(--gt-red);
      border: 3px solid var(--gt-white);
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      color: var(--gt-white);
      font-family: 'Montserrat', sans-serif;
      font-size: 12px;
      font-weight: 700;
    }

    .gt-marker--navy {
      background: var(--gt-navy);
    }

    .gt-marker--teal {
      background: var(--gt-teal);
    }

    .gt-marker--lg {
      width: 44px;
      height: 44px;
      font-size: 14px;
    }

    /* Info panel */
    .info-panel {
      position: absolute;
      top: 16px;
      left: 16px;
      z-index: 1000;
      background: var(--gt-white);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
      max-width: 260px;
    }

    .info-panel h3 {
      margin: 0 0 8px;
      font-size: 16px;
      font-weight: 600;
      color: var(--gt-navy);
    }

    .info-panel p {
      margin: 0;
      font-size: 13px;
      color: var(--gt-copy);
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <header class="page-header">
    <h1>GivingTuesday Global Participation Map</h1>
    <p>Explore giving data by region - 2024 Campaign Results</p>
  </header>

  <div class="container">
    <div class="map-section">
      <div class="map-container">
        <div id="map"></div>
      </div>

      <div class="sidebar">
        <!-- Stats Panel -->
        <div class="panel">
          <h3 class="panel__title">Global Overview</h3>
          <div class="stat-grid">
            <div class="stat-item">
              <div class="stat-number">$3.1B</div>
              <div class="stat-label">Total Raised</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">80+</div>
              <div class="stat-label">Countries</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">35M</div>
              <div class="stat-label">Participants</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">150K</div>
              <div class="stat-label">Organizations</div>
            </div>
          </div>
        </div>

        <!-- Filters Panel -->
        <div class="panel">
          <h3 class="panel__title">Filters</h3>
          <div class="filter-group">
            <label class="filter-label">Region</label>
            <select class="filter-select" id="regionFilter">
              <option value="all">All Regions</option>
              <option value="na">North America</option>
              <option value="eu">Europe</option>
              <option value="ap">Asia Pacific</option>
              <option value="la">Latin America</option>
              <option value="af">Africa</option>
            </select>
          </div>
          <div class="filter-group">
            <label class="filter-label">Data Layer</label>
            <select class="filter-select" id="layerFilter">
              <option value="donations">Total Donations</option>
              <option value="participants">Participants</option>
              <option value="orgs">Organizations</option>
              <option value="growth">YoY Growth</option>
            </select>
          </div>
          <div class="filter-group">
            <label class="filter-label">Year</label>
            <select class="filter-select" id="yearFilter">
              <option value="2024">2024</option>
              <option value="2023">2023</option>
              <option value="2022">2022</option>
              <option value="2021">2021</option>
            </select>
          </div>
        </div>

        <!-- Legend Panel -->
        <div class="panel">
          <h3 class="panel__title">Legend</h3>
          <div class="legend-item">
            <div class="legend-color" style="background: var(--gt-red);"></div>
            <span class="legend-label">High participation (>1M)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: var(--gt-navy);"></div>
            <span class="legend-label">Medium (100K-1M)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: var(--gt-teal);"></div>
            <span class="legend-label">Growing (<100K)</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // Initialize map
    const map = L.map('map', {
      center: [20, 0],
      zoom: 2,
      minZoom: 2,
      maxZoom: 10
    });

    // Add tile layer (using CartoDB Positron for clean look)
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 20
    }).addTo(map);

    // Custom marker icon
    function createMarkerIcon(color, size = 'md') {
      const sizes = { sm: 24, md: 32, lg: 44 };
      const s = sizes[size];

      return L.divIcon({
        className: 'custom-marker',
        html: `<div class="gt-marker${color !== 'red' ? ' gt-marker--' + color : ''}${size === 'lg' ? ' gt-marker--lg' : ''}"></div>`,
        iconSize: [s, s],
        iconAnchor: [s/2, s/2],
        popupAnchor: [0, -s/2]
      });
    }

    // Sample data points
    const locations = [
      {
        name: "United States",
        coords: [39.8283, -98.5795],
        donations: "$2.47B",
        participants: "18.5M",
        orgs: "75,000+",
        growth: "+8%",
        color: "red",
        size: "lg"
      },
      {
        name: "United Kingdom",
        coords: [55.3781, -3.4360],
        donations: "$182M",
        participants: "2.1M",
        orgs: "12,000+",
        growth: "+15%",
        color: "red",
        size: "md"
      },
      {
        name: "Canada",
        coords: [56.1304, -106.3468],
        donations: "$95M",
        participants: "1.8M",
        orgs: "8,500+",
        growth: "+12%",
        color: "red",
        size: "md"
      },
      {
        name: "Germany",
        coords: [51.1657, 10.4515],
        donations: "$78M",
        participants: "950K",
        orgs: "4,200+",
        growth: "+22%",
        color: "navy",
        size: "md"
      },
      {
        name: "Australia",
        coords: [-25.2744, 133.7751],
        donations: "$45M",
        participants: "620K",
        orgs: "3,100+",
        growth: "+18%",
        color: "navy",
        size: "md"
      },
      {
        name: "Brazil",
        coords: [-14.2350, -51.9253],
        donations: "$28M",
        participants: "410K",
        orgs: "2,800+",
        growth: "+35%",
        color: "teal",
        size: "md"
      },
      {
        name: "India",
        coords: [20.5937, 78.9629],
        donations: "$22M",
        participants: "380K",
        orgs: "2,100+",
        growth: "+42%",
        color: "teal",
        size: "md"
      },
      {
        name: "Kenya",
        coords: [-0.0236, 37.9062],
        donations: "$8M",
        participants: "95K",
        orgs: "850+",
        growth: "+55%",
        color: "teal",
        size: "md"
      },
      {
        name: "France",
        coords: [46.2276, 2.2137],
        donations: "$52M",
        participants: "680K",
        orgs: "3,400+",
        growth: "+19%",
        color: "navy",
        size: "md"
      },
      {
        name: "Japan",
        coords: [36.2048, 138.2529],
        donations: "$38M",
        participants: "290K",
        orgs: "1,800+",
        growth: "+28%",
        color: "teal",
        size: "md"
      }
    ];

    // Add markers
    locations.forEach(loc => {
      const marker = L.marker(loc.coords, {
        icon: createMarkerIcon(loc.color, loc.size)
      }).addTo(map);

      // Create popup content
      const popupContent = `
        <div class="gt-popup__header">GivingTuesday 2024</div>
        <h4 class="gt-popup__title">${loc.name}</h4>
        <div class="gt-popup__stat">
          <span class="gt-popup__stat-label">Total Donations</span>
          <span class="gt-popup__stat-value">${loc.donations}</span>
        </div>
        <div class="gt-popup__stat">
          <span class="gt-popup__stat-label">Participants</span>
          <span class="gt-popup__stat-value">${loc.participants}</span>
        </div>
        <div class="gt-popup__stat">
          <span class="gt-popup__stat-label">Organizations</span>
          <span class="gt-popup__stat-value">${loc.orgs}</span>
        </div>
        <div class="gt-popup__stat">
          <span class="gt-popup__stat-label">YoY Growth</span>
          <span class="gt-popup__stat-value" style="color: #0fb5c3;">${loc.growth}</span>
        </div>
      `;

      marker.bindPopup(popupContent, {
        maxWidth: 280,
        className: 'gt-popup-container'
      });
    });

    // Add info panel
    const infoPanel = L.control({ position: 'topleft' });
    infoPanel.onAdd = function(map) {
      const div = L.DomUtil.create('div', 'info-panel');
      div.innerHTML = `
        <h3>Explore the Data</h3>
        <p>Click on any marker to see detailed participation data for that region. Use the filters on the right to customize your view.</p>
      `;
      return div;
    };
    infoPanel.addTo(map);

    // Filter functionality (demo)
    document.querySelectorAll('.filter-select').forEach(select => {
      select.addEventListener('change', function() {
        console.log('Filter changed:', this.id, this.value);
        // In a real implementation, this would filter the map data
      });
    });
  </script>
</body>
</html>
